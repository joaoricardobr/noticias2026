<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NewsFlow - G1 Feeds</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.22.5/babel.min.js"></script>
  <style>
    body { transition: background-color 0.3s ease, color 0.3s ease; }
    .news-card-hover { border: 2px solid transparent; transition: border-color 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease; }
    .news-card-hover:hover {}
    .news-count-badge { min-width: 2rem; }
     /* Garante que a imagem dentro do 'prose' no modal não seja exibida */
    .modal-content-prose img {
        display: none !important;
    }
  </style>
</head>
<body class="min-h-screen flex flex-col font-sans">
  <div id="root"></div>

  <script type="text/babel">
    // --- Configurações, Proxy, Placeholders, Utilitários, SpeechManager (mantidos como na versão anterior) ---
    const rssFeeds = { /* ... */
        "Todas": "https://g1.globo.com/dynamo/rss2.xml", "Brasil": "https://g1.globo.com/dynamo/brasil/rss2.xml", "Carros": "https://g1.globo.com/dynamo/carros/rss2.xml", "Ciência e Saúde": "https://g1.globo.com/dynamo/ciencia-e-saude/rss2.xml", "Concursos": "https://g1.globo.com/dynamo/concursos-e-emprego/rss2.xml", "Economia": "https://g1.globo.com/dynamo/economia/rss2.xml", "Mundo": "https://g1.globo.com/dynamo/mundo/rss2.xml", "Música": "https://g1.globo.com/dynamo/musica/rss2.xml", "Natureza": "https://g1.globo.com/dynamo/natureza/rss2.xml", "Planeta Bizarro": "https://g1.globo.com/dynamo/planeta-bizarro/rss2.xml", "Política": "https://g1.globo.com/dynamo/politica/mensalao/rss2.xml", "Pop & Arte": "https://g1.globo.com/dynamo/pop-arte/rss2.xml", "Tecnologia": "https://g1.globo.com/dynamo/tecnologia/rss2.xml", "Turismo": "https://g1.globo.com/dynamo/turismo-e-viagem/rss2.xml",
     };
    const CORS_PROXY = "https://corsproxy.io/?";
    // const CORS_PROXY = "https://api.allorigins.win/raw?url=";
    const PLACEHOLDER_IMAGE = "https://via.placeholder.com/600x400/cccccc/969696.png?text=Imagem+Indisponível";
    const stripHtml = (html) => { if (!html) return ""; const tmp = document.createElement("DIV"); tmp.innerHTML = html; return tmp.textContent || tmp.innerText || ""; }
    const formatDate = (dateString) => { try { const date = new Date(dateString); return date.toLocaleDateString("pt-BR", { day: '2-digit', month: 'short', year: 'numeric', }); } catch (e) { return "Data inválida"; } };
    const speechManager = { /* ...código mantido... */
         utterance: null, isSpeaking: false, speakingItemId: null, speak: function(text, itemId, onEndCallback) { if (!('speechSynthesis' in window)) return alert("Navegador não suporta voz."); if (this.isSpeaking && this.speakingItemId === itemId) return window.speechSynthesis.cancel(); if(window.speechSynthesis.speaking) window.speechSynthesis.cancel(); const cleanText = stripHtml(text); if (!cleanText) return; this.utterance = new SpeechSynthesisUtterance(cleanText); this.utterance.lang = 'pt-BR'; const voices = window.speechSynthesis.getVoices(); const portugueseVoice = voices.find(voice => voice.lang === 'pt-BR'); if (portugueseVoice) this.utterance.voice = portugueseVoice; this.utterance.onstart = () => { this.isSpeaking = true; this.speakingItemId = itemId; }; this.utterance.onend = () => { if (this.speakingItemId === itemId) { this.isSpeaking = false; this.speakingItemId = null; this.utterance = null; onEndCallback(); } }; this.utterance.onerror = (event) => { console.error("Speech Error:", event); if (this.speakingItemId === itemId) { this.isSpeaking = false; this.speakingItemId = null; this.utterance = null; onEndCallback(); alert(`Erro leitura: ${event.error}`); } }; window.speechSynthesis.speak(this.utterance); }, cancel: function(onEndCallback) { if (window.speechSynthesis.speaking || this.utterance) { window.speechSynthesis.cancel(); this.isSpeaking = false; this.speakingItemId = null; this.utterance = null; if (onEndCallback) onEndCallback(); } }, loadVoices: function() { if ('speechSynthesis' in window && window.speechSynthesis.onvoiceschanged !== undefined) { window.speechSynthesis.onvoiceschanged = () => {}; window.speechSynthesis.getVoices(); } }
    };

    // --- Componentes (AdBanner, AdCard, PremiumAdModal - mantidos) ---
     const AdBanner = ({ position, isDarkMode }) => { /* ... */
         return ( <div className={`py-4 px-6 rounded-lg shadow-md text-center ${isDarkMode ? "bg-gray-700 text-gray-200" : "bg-gray-100 text-gray-800"}`}> <p className="text-base font-semibold"> {position === "top" ? "Anúncio - Topo" : position === "modal" ? "Anúncio - Modal" : position === "premium-modal" ? "Anúncio - Premium" : "Anúncio - Rodapé"} </p> <p className="text-sm mt-2"> {position === "top" ? "Ofertas!" : position === "modal" ? "Novidades!" : position === "premium-modal" ? "Sem interrupções!" : "Mais conteúdos!"} </p> <a href="#" className={`inline-block mt-3 px-5 py-2 rounded-lg text-sm font-medium transition-colors duration-200 ${isDarkMode ? "bg-blue-600 text-white hover:bg-blue-700" : "bg-blue-500 text-white hover:bg-blue-600"}`} onClick={(e) => e.preventDefault()} > Saiba mais </a> </div> );
      };
     const AdCard = ({ isDarkMode }) => { /* ... */
          return ( <div className={`rounded-lg overflow-hidden shadow-lg flex flex-col h-full p-5 text-center news-card-hover ${isDarkMode ? "bg-gray-800 text-gray-200 hover:border-gray-600" : "bg-white text-gray-800 hover:border-gray-300"}`}> <div className="flex-grow flex flex-col items-center justify-center"> <p className="text-lg font-bold mb-2">Publicidade</p> <p className={`text-sm mb-4 ${isDarkMode ? "text-gray-400" : "text-gray-600"}`}> Anuncie aqui! </p> <a href="#" className={`inline-block px-5 py-2 rounded-lg text-sm font-medium transition-colors duration-200 ${ isDarkMode ? "bg-green-600 text-white hover:bg-green-700" : "bg-green-500 text-white hover:bg-green-600" }`} onClick={(e) => e.preventDefault()} > Anuncie Conosco </a> </div> </div> );
      };
     const PremiumAdModal = ({ onClose, isDarkMode }) => { /* ... */
         const handleBuyPremium = () => { alert("Compra Premium..."); onClose(); }; const handleWatchAds = () => { alert("Assistir Ads..."); onClose(); }; return ( <div className={`fixed inset-0 flex items-center justify-center z-50 ${isDarkMode ? "bg-gray-900 bg-opacity-75" : "bg-gray-100 bg-opacity-75"}`}> <div className={`rounded-lg shadow-xl p-6 max-w-md w-full ${isDarkMode ? "bg-gray-800 text-white" : "bg-white text-gray-800"}`}> <div className="flex justify-between items-center mb-4"> <h2 className="text-xl font-bold">NewsFlow Premium!</h2> <button onClick={onClose} className={`p-1 rounded-full transition-colors duration-200 ${isDarkMode ? "text-gray-400 hover:text-white hover:bg-gray-700" : "text-gray-600 hover:text-gray-800 hover:bg-gray-200"}`}> <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12" /> </svg> </button> </div> <p className={`text-sm mb-4 ${isDarkMode ? "text-gray-300" : "text-gray-600"}`}> Sem anúncios. Escolha: </p> <div className="mb-6"> <AdBanner position="premium-modal" isDarkMode={isDarkMode} /> </div> <div className="flex flex-col space-y-4"> <button onClick={handleBuyPremium} className={`w-full px-5 py-3 rounded-lg text-sm font-medium transition-colors duration-200 ${ isDarkMode ? "bg-blue-600 text-white hover:bg-blue-700" : "bg-blue-500 text-white hover:bg-blue-600" }`} > Comprar (R$ 4,90) </button> <button onClick={handleWatchAds} className={`w-full px-5 py-3 rounded-lg text-sm font-medium transition-colors duration-200 ${ isDarkMode ? "bg-gray-600 text-white hover:bg-gray-700" : "bg-gray-300 text-gray-800 hover:bg-gray-400" }`} > Ver 4 Ads (Grátis 24h) </button> </div> </div> </div> );
      };

    // Navigation (mantido)
    const Navigation = ({ onCategoryChange, activeCategory, isDarkMode }) => { /* ... */
         const [isMenuOpen, setIsMenuOpen] = React.useState(false); const navItems = [ { label: "Todas", icon: "M3 12h18M3 6h18M3 18h18" }, { label: "Brasil", icon: "M15 12a3 3 0 11-6 0 3 3 0 016 0z M21 12a9 9 0 11-18 0 9 9 0 0118 0z" }, { label: "Carros", icon: "M19 7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2V7z" }, { label: "Ciência e Saúde", icon: "M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" }, { label: "Concursos", icon: "M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" }, { label: "Economia", icon: "M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" }, { label: "Mundo", icon: "M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z" }, { label: "Música", icon: "M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2z" }, { label: "Natureza", icon: "M17.657 18.657l-4.243-4.243M6.343 5.343l4.243 4.243M17.657 5.343l-4.243 4.243M6.343 18.657l4.243-4.243M12 16a4 4 0 110-8 4 4 0 010 8z" }, { label: "Planeta Bizarro", icon: "M12 14l9-5-9-5-9 5 9 5zm0 7l9-5-9-5-9 5 9 5z" }, { label: "Política", icon: "M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192l-3.536 3.536M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0z" }, { label: "Pop & Arte", icon: "M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z" }, { label: "Tecnologia", icon: "M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" }, { label: "Turismo", icon: "M17.657 4.343a8 8 0 11-11.314 11.314L12 21.213l5.657-5.556a8 8 0 010-11.314zM12 12a3 3 0 100-6 3 3 0 000 6z" }, { label: "Favoritos", icon: "M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z", iconClass: isDarkMode ? "text-red-500" : "text-red-600" } ]; return ( <nav className={`p-4 rounded-lg shadow-lg ${isDarkMode ? "bg-gray-800" : "bg-gray-200"}`}> <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"> <div className="flex justify-between items-center sm:hidden"> <span className={`font-semibold ${isDarkMode ? 'text-gray-300' : 'text-gray-700'}`}>Categorias</span> <button onClick={() => setIsMenuOpen(!isMenuOpen)} className={`p-2 rounded-lg ${isDarkMode ? "text-gray-300 hover:bg-gray-700" : "text-gray-700 hover:bg-gray-300"}`}> <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d={isMenuOpen ? "M6 18L18 6M6 6l12 12" : "M4 6h16M4 12h16M4 18h16"} /> </svg> </button> </div> {isMenuOpen && ( <div className="sm:hidden mt-2 space-y-1"> {navItems.map((item, index) => ( <button key={index} onClick={() => { onCategoryChange(item.label); setIsMenuOpen(false); }} className={`flex items-center w-full p-3 rounded-lg transition-all duration-200 text-left ${ activeCategory === item.label ? (isDarkMode ? "bg-blue-600 text-white" : "bg-blue-500 text-white") : (isDarkMode ? "text-gray-300 hover:bg-gray-700" : "text-gray-700 hover:bg-gray-300") }`} > <svg xmlns="http://www.w3.org/2000/svg" className={`h-5 w-5 flex-shrink-0 ${item.iconClass || ""}`} fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d={item.icon} /> </svg> <span className="ml-3 text-sm font-medium">{item.label}</span> </button> ))} </div> )} <div className="hidden sm:flex flex-wrap justify-center gap-2"> {navItems.map((item, index) => ( <button key={index} onClick={() => onCategoryChange(item.label)} title={item.label} className={`flex items-center p-2 rounded-lg transition-all duration-300 group relative ${ activeCategory === item.label ? (isDarkMode ? "bg-blue-600 text-white shadow-md" : "bg-blue-500 text-white shadow-md") : (isDarkMode ? "text-gray-300 hover:bg-gray-700 hover:text-blue-400" : "text-gray-700 hover:bg-gray-300 hover:text-blue-600") }`} > <svg xmlns="http://www.w3.org/2000/svg" className={`h-6 w-6 flex-shrink-0 ${item.iconClass || ""}`} fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d={item.icon} /> </svg> <span className="ml-2 text-sm font-medium hidden md:inline">{item.label}</span> </button> ))} </div> </div> </nav> );
     };

    // SearchAndFilters - Atualizado para responsividade mobile
    const SearchAndFilters = ({ searchQuery, setSearchQuery, sortBy, setSortBy, handleRefresh, isDarkMode, isLoading }) => {
        return (
        <div className={`p-4 rounded-lg shadow-md ${isDarkMode ? "bg-gray-800" : "bg-gray-200"}`}>
            {/* Container principal agora ajusta flex-direction baseado em 'sm' */}
            <div className="flex flex-col sm:flex-row sm:items-center gap-4">
            {/* Campo de Busca */}
            <div className="flex-grow relative">
                <input
                type="text"
                placeholder="Buscar notícias..."
                value={searchQuery}
                onChange={(e) => setSearchQuery(e.target.value)}
                className={`w-full h-10 p-3 pl-10 rounded-lg focus:outline-none focus:ring-2 transition-all duration-200 ${
                    isDarkMode
                    ? "bg-gray-700 text-white placeholder-gray-400 focus:ring-blue-500"
                    : "bg-gray-300 text-gray-800 placeholder-gray-600 focus:ring-blue-400"
                }`}
                />
                <svg /* ícone lupa */ xmlns="http://www.w3.org/2000/svg" className={`h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 ${isDarkMode ? "text-gray-400" : "text-gray-600"}`} fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /> </svg>
            </div>

            {/* Grupo de Filtros e Botão - AGORA SEMPRE flex-row */}
            <div className="flex flex-row gap-3 items-center flex-shrink-0 w-full sm:w-auto"> {/* w-full no mobile */}
                <select
                value={sortBy}
                onChange={(e) => setSortBy(e.target.value)}
                className={`h-10 p-2 rounded-lg focus:outline-none focus:ring-2 transition-all duration-200 flex-grow sm:flex-grow-0 ${ /* flex-grow no mobile */
                    isDarkMode
                    ? "bg-gray-700 text-white focus:ring-blue-500"
                    : "bg-gray-300 text-gray-800 focus:ring-blue-400"
                }`}
                >
                <option value="newest">Recentes</option>
                <option value="oldest">Antigos</option>
                <option value="title-asc">Título A-Z</option>
                <option value="title-desc">Título Z-A</option>
                </select>
                <button
                onClick={handleRefresh}
                disabled={isLoading}
                className={`h-10 flex items-center justify-center px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 flex-shrink-0 ${
                    isDarkMode
                    ? "bg-blue-500 text-white hover:bg-blue-600 disabled:bg-blue-700 disabled:opacity-70"
                    : "bg-blue-400 text-white hover:bg-blue-500 disabled:bg-blue-300 disabled:opacity-70"
                }`}
                >
                    {/* Ícone de loading ou refresh */}
                    {isLoading ? ( <svg className="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"> <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle> <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path> </svg> ) : ( <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" /> </svg> )}
                    <span className="hidden sm:inline ml-2">{isLoading ? 'Atualizando...' : 'Atualizar'}</span> {/* Texto some no mobile */}
                </button>
            </div>
            </div>
        </div>
        );
    };


    // NewsCard (mantido)
    const NewsCard = ({ news, onOpenModal, isDarkMode, toggleFavorite, isFavorited, currentlySpeakingId, setCurrentlySpeakingId }) => { /* ... */
         const isCurrentlySpeaking = news.id === currentlySpeakingId; const handleSpeakClick = (event) => { event.stopPropagation(); if (!news.title) return; speechManager.speak(news.title, news.id, () => { setCurrentlySpeakingId(null); }); setCurrentlySpeakingId(speechManager.isSpeaking ? news.id : null); }; const hoverBorderColorClass = isDarkMode ? 'hover:border-blue-400' : 'hover:border-blue-500'; return ( <div className={`news-card-hover ${hoverBorderColorClass} rounded-lg overflow-hidden shadow-lg hover:shadow-2xl transform hover:-translate-y-1 flex flex-col h-full cursor-pointer ${isDarkMode ? "bg-gray-800" : "bg-white"}`} onClick={() => onOpenModal(news)} role="article" aria-labelledby={`news-title-${news.id}`} > <div className="relative"> <img src={news.image || PLACEHOLDER_IMAGE} alt={`Imagem para: ${news.title}`} className="w-full h-48 object-cover sm:h-56 md:h-64" loading="lazy" onError={(e) => e.target.src = PLACEHOLDER_IMAGE} /> {news.category && ( <span className={`absolute top-2 left-2 text-white text-xs font-medium px-2 py-1 rounded-lg shadow ${isDarkMode ? "bg-blue-600" : "bg-blue-500"}`}> {news.category} </span> )} </div> <div className="p-5 flex flex-col flex-grow"> <div className="flex justify-between items-center mb-2 text-xs"> <p className={`font-medium ${isDarkMode ? "text-blue-400" : "text-blue-600"}`}>{news.source || "G1"}</p> {news.date && <p className={`${isDarkMode ? "text-gray-400" : "text-gray-600"}`}>{news.date}</p>} </div> <h3 id={`news-title-${news.id}`} className={`text-lg font-semibold line-clamp-3 mb-2 flex-grow ${isDarkMode ? "text-white" : "text-gray-900"}`}>{news.title || "Título"}</h3> {news.summary && <p className={`text-sm line-clamp-2 mt-1 ${isDarkMode ? "text-gray-300" : "text-gray-600"}`}>{news.summary}</p>} <div className={`flex justify-between items-center mt-4 pt-4 border-t ${isDarkMode ? 'border-gray-700' : 'border-gray-200'}`}> <button onClick={(e) => { e.stopPropagation(); toggleFavorite(news.id); }} title={isFavorited ? "Remover Favorito" : "Adicionar Favorito"} className={`flex items-center p-2 rounded-full transition-colors duration-200 ${ isFavorited ? (isDarkMode ? "text-red-500 hover:bg-red-900 hover:bg-opacity-20" : "text-red-600 hover:bg-red-100") : (isDarkMode ? "text-gray-400 hover:text-red-400 hover:bg-gray-700" : "text-gray-600 hover:text-red-600 hover:bg-gray-200") }`} > <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill={isFavorited ? "currentColor" : "none"} viewBox="0 0 24 24" stroke="currentColor" strokeWidth={isFavorited ? 1 : 2}> <path strokeLinecap="round" strokeLinejoin="round" d="M4.318 6.318a4